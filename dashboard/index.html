<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HTTP-AI Server Dashboard (Realtime)</title>
  <link rel="stylesheet" href="./styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">‚ö°</div>
      <div>
        <div class="title">HTTP-AI Server Dashboard</div>
        <div class="subtitle">Realtime t·ª´ log CSV qua WebSocket</div>
      </div>
    </div>
    <div class="status">
      <span id="wsState" class="pill gray">WS: disconnected</span>
      <span id="lastSeen" class="pill">Last: -</span>
      <span id="algoNow" class="pill">Algo: -</span>
    </div>
  </header>

  <main class="container">
    <!-- M√†n 1 -->
    <section class="grid3">
      <div class="card">
        <div class="card-h">CPU</div>
        <div class="card-v" id="cpuVal">-</div>
        <div class="card-f">SystemMetrics</div>
      </div>
      <div class="card">
        <div class="card-h">Queue length</div>
        <div class="card-v" id="qVal">-</div>
        <div class="card-f">pending tasks</div>
      </div>
      <div class="card">
        <div class="card-h">Current scheduler</div>
        <div class="card-v" id="schedVal">-</div>
        <div class="card-f">algo_at_run</div>
      </div>
    </section>

    <!-- M√†n 2 -->
    <section class="card big">
      <div class="section-title">üîÑ Scheduler Timeline</div>
      <div class="section-sub">Timeline: th·ªùi gian ‚Üí thu·∫≠t to√°n. D·∫•u ch·∫•m = l√∫c switch.</div>
      <canvas id="timelineChart"></canvas>
    </section>

    <!-- M√†n 3 -->
    <section class="card big">
      <div class="section-title">ü§ñ AI Decision</div>
      <div class="section-sub">Feature input + predicted algorithm + fallback (n·∫øu c√≥ trong log).</div>

      <div class="grid3 mt">
        <div class="panel">
          <div class="panel-h">Feature snapshot</div>
          <div class="kv"><span>cpu</span><b id="ai_cpu">-</b></div>
          <div class="kv"><span>queue_len</span><b id="ai_q">-</b></div>
          <div class="kv"><span>estimated_workload</span><b id="ai_est">-</b></div>
          <div class="kv"><span>req_size</span><b id="ai_size">-</b></div>
          <div class="kv"><span>method</span><b id="ai_method">-</b></div>
          <div class="kv"><span>path_len</span><b id="ai_pathlen">-</b></div>
        </div>

        <div class="panel">
          <div class="panel-h">Prediction</div>
          <div class="kv"><span>predicted</span><b id="ai_pred">-</b></div>
          <div class="kv"><span>fallback</span><b id="ai_fallback">-</b></div>
          <div class="hint">
            N·∫øu log ch∆∞a c√≥ <code>ai_predicted</code>/<code>ai_fallback</code>, panel n√†y s·∫Ω hi·ªán ‚Äúch∆∞a log‚Äù.
          </div>
        </div>

        <div class="panel">
          <div class="panel-h">Runtime</div>
          <div class="kv"><span>algo_at_run</span><b id="ai_run">-</b></div>
          <div class="kv"><span>algo_at_enqueue</span><b id="ai_enq">-</b></div>
          <div class="kv"><span>latency(ms)</span><b id="ai_rt">-</b></div>
          <div class="kv"><span>latAvg(ms)</span><b id="ai_latavg">-</b></div>
        </div>
      </div>
    </section>

    <!-- M√†n 4 -->
    <section class="grid2">
      <div class="card big">
        <div class="section-title">üìà Avg latency by algorithm</div>
        <div class="section-sub">T√≠nh t·ª´ response_time_ms theo algo_at_run.</div>
        <canvas id="latencyChart"></canvas>
      </div>

      <div class="card big">
        <div class="section-title">üìà Throughput by algorithm</div>
        <div class="section-sub">∆Ø·ªõc l∆∞·ª£ng req/s theo c·ª≠a s·ªï th·ªùi gian.</div>
        <canvas id="throughputChart"></canvas>
      </div>
    </section>

    <footer class="foot">
      Tip: m·ªü b·∫±ng <code>python3 -m http.server</code> ƒë·ªÉ tr√°nh CORS l·∫∑t v·∫∑t.
    </footer>
  </main>

  <script src="./app.js"></script>
</body>
</html>
